<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">

<!-- 
CREATED BY	: VINOTH KUMAR S 
CREATED ON	: 02.07.2025
PURPOSE		: BRFVALIDATIONS
-->

<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:th="http://www.thymeleaf.org">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/4.3.1/css/bootstrap.min.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/webjars/font-awesome/5.9.0/css/all.min.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}">
	<link rel="stylesheet" th:href="@{/css/CustomButton.css}" />
	<link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon" />

	<!-- JavaScript -->
	<!-- jQuery core (required first) -->
	

	<!-- ✅ Your manually placed jQuery validation
	<script th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
	 <script th:src="/jquery/jquery.validate.min.js"></script>
	 --> 
	
	<script th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
	<!-- jQuery (required first) -->
<!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> -->

<!-- ✅ jQuery Validation -->
<script src="/webjars/jquery-validation/1.19.0/jquery.validate.min.js"
	th:src="@{/webjars/jquery-validation/1.19.0/jquery.validate.min.js}"></script>
	
	<!-- Bootstrap + Others -->
	<script th:src="@{/webjars/popper.js/1.14.7/umd/popper.min.js}"></script>
	<script th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
	<script th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>
	<script th:src="@{/webjars/jquery-form/4.2.2/jquery.form.min.js}"></script>
	<script th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
	<script th:src="@{/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js}"></script>



<style>
.btns {
	float: right;
	margin: 5px;
}

.col-sm-5 {
	padding-bottom: 15px;
}

.list-body {
	padding: 0px;
}

.error {
	color: red;
	padding-left: 10px;
}

.formline {
	padding-bottom: 15px;
}

.btn-primary {
	background-color: #E77400;
	border-color: #0c0c0c;
}

.btn-primary:not (:disabled ):not (.disabled ).active, .btn-primary:not
	 (:disabled ):not (.disabled ):active, .show>.btn-primary.dropdown-toggle
	{
	color: #fff;
	background-color: #cc000000;
	border-color: #161617;
}

#finusertb {
	width: 460px;
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
	padding: 0px;
}
</style>
 
  
 
 
 <style>
  .card {
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    border-radius: 8px;
  }

  .card-header h5 {
    font-size: 22px;
    color: #fff;
    font-weight: 600;
  }

  .nav-tabs .nav-link {
    font-weight: 500;
    border: 1px solid #dee2e6;
    border-bottom: none;
    border-radius: 4px 4px 0 0;
    background-color: #f1f1f1;
    margin-right: 5px;
  }

  .nav-tabs .nav-link.active {
    background-color: #ffffff;
    border-color: #dee2e6 #dee2e6 #ffffff;
  }

  .table-responsive {
    border: 1px solid #dee2e6;
    border-radius: 4px;
  }

  .table-hover tbody tr:hover {
    background-color: #f3f6f9;
  }

  thead th {
    position: sticky;
    top: 0;
    background-color: #e9ecf0;
    z-index: 1;
  }

  .card-footer {
    padding: 10px;
    border-top: 1px solid #ccc;
  }

  .btn-xs {
    padding: 4px 12px;
    font-size: 14px;
    border-radius: 4px;
  }

  #BRFvalidation th, #usertable td {
    vertical-align: middle;
    text-align: left;
    font-size: 16px;
    font-family: Arial;
  }

  .fa-edit:hover {
    color: #28a745;
    transform: scale(1.1);
  }



td {
  border: 1px solid rgb(0,164,166);
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

</style>
 

<style>
        .form-group {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .form-control {
            width: 100%;
            border: 2px solid #ccc;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            background: transparent;
            transition: border-color 0.3s ease, padding-top 0.3s ease;
        }
        .error {
    		color: red;
    		padding-top: 15px;
			}
        
        

        .form-control:focus {
            border-color: #007bff;
        }

        .form-legend {
            position: absolute;
            top: 50%;
            left: 15px;
            transform: translateY(-50%);
            font-size: 1rem;
            color: #aaa;
            background: white;
            padding: 0 5px;
            pointer-events: none;
            transition: 0.3s ease;
        }

        /* When input or select is focused or has a value, move the label up */
        .form-control:focus ~ .form-legend,
        .form-control:not(:placeholder-shown) ~ .form-legend {
            top: -8px;
            font-size: 1rem;
            color: #007bff;
        }

        /* Hover effect when the input/select is focused */
        .form-control:focus:hover ~ .form-legend {
            color: #0056b3; /* Darker shade of blue on hover */
        }

        /* Ensure the label returns to the normal color after focus or hover is removed */
        .form-control:not(:focus) ~ .form-legend {
            color: #aaa; /* Normal label color */
        }
    </style>
   
    <style>
/* Red border for invalid inputs */
input.error, select.error {
  border: 2px solid red !important;
}

/* Error message style */
label.error {
  color: red;
  font-size: 0.85em;
  margin-top: 5px;
  display: block;
}

.left-arrow-circle {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    background-color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 10px;
    transition: background-color 0.3s, transform 0.2s;
}

.left-arrow-circle i {
    color: rgb(107, 122, 143);
}

.left-arrow-circle:hover {
    background-color: rgb(107, 122, 143);
    cursor: pointer;
    transform: scale(1.05);
    border: 2px solid white;
}

.left-arrow-circle:hover i {
    color: white;
}

.white-text span {
	color: white !important;
}
</style>
    

<script th:inline="javascript">

		$(document).ready(function() {
		    $('#loader').modal('hide');
		});
		
		$(window).on("pageshow", function(event) {
		    $('#loader').modal('hide');
		});

	

	function home() {
        $("#loader").modal("toggle");
		location.href = 'Dashboard'
	}

	function back() {
        $("#loader").modal("toggle");

		window.history.back();
	}

	

	function getReport(a) {
	    // Show loader
	    //$('#loader').modal('show');

	    // Retrieve data attributes
	    var fromdate = a.getAttribute("data-fromdate");
	    var todate = a.getAttribute("data-todate");
	    var asondate = a.getAttribute("data-todate");
	    var reportid = a.getAttribute("data-rptcode");
	    
	    let showModal = false;
	    $('tbody .userlist').each(function () {
	        var cur_status = $(this).find('td').eq(4).text().trim();
	        if (cur_status === 'Not ok') {
	            showModal = true;
	        }
	    });
	    
	    
	    if (showModal) {
	        // Hide loader before showing the modal
	        $('#loader').modal('hide');
	        $('#validationModal').modal('show');
	        $('#confirmGenerateReport').off('click').one('click', function () {
	        	 $('#validationModal').modal('hide');
	            if (confirm("Do you want to open report?")) {
	                $('#loader').modal('show'); // Show again before submission
	                const type = 'RBS';
	                $('#loader').modal('hide');
	                location.href = "Reports/"+reportid+"?dtltype=report&fromdate="+fromdate+"&todate="+todate+"&type="+type+"&asondate="+asondate;
	            }
	            else{
			    	$('#loader').modal('hide');
			    }
	        });
	    } else {
	    	
		    if (confirm("Do you want to open reports?")) {
	            const type = 'RBS';
	            $('#loader').modal('show');
	            location.href = "Reports/"+reportid+"?dtltype=report&fromdate="+fromdate+"&todate="+todate+"&type="+type+"&asondate="+asondate;
	            
	            //$("#reportform").attr('action', `Reports/${reportid}?dtltype=report&fromdate=${fromdate}&todate=${todate}&type=${type}&asondate=${asondate}`);
	            //form.submit();
	        }
		    else{
		    	$('#loader').modal('hide');
		    }
	    }
	    
	    

	    

	   
	    
	}
	
	$(document).ready(function () {
	    // Hide loader when validation modal is shown
	    $('#validationModal').on('shown.bs.modal', function () {
	        $('#loader').modal('hide');
	    });
	});


	
    </script>
    
  
</head>

 
     
<title>BRFVALIDATION</title>
<body> 
<div class="container-fluid" style="padding-left:0px; padding-right:0px;">
		<div class="row">
		
			<div th:insert="HeaderMenu :: header"></div>

			
			<div class="card" >
			
			<div class="card-header" style="background-color: rgb(107, 122, 143); display: flex; align-items: center; justify-content: space-between;">
			    <div style="display: flex; align-items: center;" onclick="back();">
			        <!-- ⬅️ Left circular arrow -->
			        <div class="left-arrow-circle">
			    		<i class="fa fa-arrow-left"></i>
					</div>
			        <!-- Title -->
			        <h5 style="font-family: arial; font-size: 20px; padding-top:10px; font-weight: bold; color: white;">BRF Report Validations</h5>
   				 </div>

			    <div class="custom-tab-btn-group nav-buttons" style="display: flex; color: white; align-items: center;">
		
			        <!-- Buttons -->
			    
			        <button type="button" class="custom-tab-btn" id="custom-tab-btnSummary" th:attr="data-rptcode=${reportlist1.rptCode},data-fromdate=${#dates.format(reportlist1.startDate, 'dd/MM/yyyy')},data-todate=${#dates.format(reportlist1.endDate, 'dd/MM/yyyy')}"
								onclick="getReport(this);">Report</button>  
					    
			    </div>  
			    </div>
			</div>
				
			

			<div class="row">
				<div class="col-sm-12">
					<div class="table-container" style="max-height: 620px; ">
					<form action="#" th:object="${reportform}" method="post"
						autocomplete="off" id="reportform">
						<table class="table table-striped table-bordered table-hover"
							id="BRFvalidation">
							<thead style="background-color:#e9ecf0; font-family: Arial;">
								<tr>
									<th>Validation Details</th>
									<th>Tables</th>
									<th>Check</th>
									<th>Validation</th>
									<th>Description</th>
								</tr>
							</thead>
							<tbody style="font-family: Arial;">
								
									<tr th:each="validationlist : ${reportlist}" class="userlist">



									<td style="display: none;"><input type="text"
										name="todate" id="disableDate" th:value="${reportDate1}"
										class="col-sm-3 form-control" placeholder="dd/mm/yyyy" /></td>


									<!-- <td th:text="${validationlist.srl_no}"></td> -->
									<td th:text="${validationlist.val_det}"></td>
									<td th:text="${validationlist.val_tables}"></td>
									<td><button class="btn-primary" type="button"
											th:attr="data-srl_no=${validationlist.srl_no},data-todate=${rpt_date}"
											form="reportform" onclick="check(this);">Check</button></td>
									<th:block th:switch="${validationlist?.cur_status}">
										<td th:case="'Y'" style="color: green;">Ok</td>
										<td th:case="'N'" style="color: red;">Not ok</td>

										<td th:case="*" style="color: red;"></td>
										<td th:text="${validationlist.remarks2}"></td>
									</th:block>

								</tr>								
							</tbody>
						</table>
						</form>
					</div>
					

				</div>
			</div>
			</div>
			


	</div>
			
		<div class="modal fade" id="loader" data-backdrop="static"
			data-keyboard="false">
			<div
				class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
				<div class="modal-content" style="background: transparent;">
					<div class="modal-body" style="text-align: center">
						<div>
							<img th:src=@{/images/loader.gif} id="bfirelogo"
								style="width: 153px; height: auto; margin-left: 18px; background-color: transparent;
								border-color: transparent;"
								alt="Bornfire">
						</div>
					</div>
				</div>
			</div>
		</div>	
		
		<div class="modal fade" id="validationModal" tabindex="-1" role="dialog" aria-labelledby="validationModalLabel" aria-hidden="true">
	    <div class="modal-dialog" role="document">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h5 id="validationModalLabel">Validation Failed</h5>
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	                    <span aria-hidden="true">&times;</span>
	                </button>
	            </div>
	            <div class="modal-body">
	                <p>Validation failed: Do you still want to generate the report?</p>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
	                <button type="button" class="btn btn-primary" id="confirmGenerateReport">Generate Report</button>
	            </div>
	        </div>
	    </div>
	</div>
		
</div>
	

	


	

	
		
</body>
  <script>
  $(document).ready(function () {
    $('#BRFvalidations').DataTable({
      pageLength: 10,
      lengthChange: false,
      searching: true,
      paging: true,
      ordering: false, // Set to true if you want column sorting
      scrollY: "350px",
      scrollCollapse: true
    });
  });
</script>

<!-- Include this after your DataTable initialization script -->

<style>
/* Remove top margin/padding from DataTables parent containers */
#data {
  padding-top: 0 !important;
  margin-top: 0 !important;
}

.table-responsive {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

/* Ensure DataTables filter (search box) doesn't have spacing above it */
div.dataTables_filter {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

  /* FIX: Make search label and box inline */
  div.dataTables_filter label {
    display: flex !important;
    align-items: center;
    gap: 8px;
    white-space: nowrap;
  }

  /* Style pagination buttons */
  .dataTables_wrapper .dataTables_paginate .paginate_button {
    background-color: white;
    border: 1px solid rgb(0,164,166);
    color: rgb(0,164,166) !important;
    padding: 5px 10px;
    margin: 2px;
    border-radius: 6px;
    transition: 0.3s;
    font-weight: 600;
  }

  .dataTables_wrapper .dataTables_paginate .paginate_button.current,
  .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
    background-color: rgb(0,164,166) !important;
    color: white !important;
  }

  /* Optional: Style the search input */
  .dataTables_filter input {
    border: 1px solid rgb(0,164,166);
    border-radius: 4px;
    padding: 4px 8px;
  }
</style>





</html>